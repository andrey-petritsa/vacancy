services:
  back:
    image: vacancy-back:${TAG:-latest}
    container_name: vacancy-back
    build:
      context: ../
      dockerfile: build/DockerfileBack
    volumes:
      - vacancy-database:/app/back/database
    ports:
      - "5001:5001"

  parser:
    image: vacancy-parse:${TAG:-latest}
    container_name: vacancy-parse
    build:
      context: ../
      dockerfile: build/DockerFileParser
    volumes:
      - vacancy-database:/app/back/database


  front:
    image: vacancy-front:${TAG:-latest}
    container_name: vacancy-front
    build:
      context: ../
      dockerfile: build/DockerfileFront
    ports:
      - "80:80"

  test:
    image: vacancy-test:${TAG:-latest}
    container_name: vacancy-test
    build:
      context: ../
      dockerfile: build/DockerfileTest
    profiles: [ "ci" ]

volumes:
  vacancy-database: